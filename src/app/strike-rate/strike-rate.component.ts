import { Component, ViewChild } from '@angular/core';
import { ChartConfiguration } from 'chart.js';
import { BaseChartDirective } from 'ng2-charts';
import { IChartData } from '../i-chart-data.dto';
import ChartDataLabels from 'chartjs-plugin-datalabels';

@Component({
  selector: 'app-strike-rate',
  standalone: true,
  imports: [BaseChartDirective],
  templateUrl: './strike-rate.component.html',
  styleUrl: './strike-rate.component.css'
})
export class StrikeRateComponent {
  @ViewChild(BaseChartDirective) chart?: BaseChartDirective;
  public chartPlugins = [ChartDataLabels];
  public data: IChartData;

  constructor() {
    this.data = {
      chartData: [
        {
          data: [19.20, 37.20, 35.14, 34.91, 43.64, 45.00, 50.14, 45.74, 44.81, 47.68, 49.78, 51.80, 52.12, 57.65, 60.19, 57.07, 57.48, 58.52, 59.93, 55.42, 57.06, 58.09, 55.08, 54.15, 57.00, 58.29, 59.91, 60.44, 59.89, 60.41, 57.35, 58.02, 60.61, 61.61, 61.50, 60.95, 61.48, 62.71, 59.82, 59.39, 60.00, 60.60, 59.75, 59.68, 58.20, 58.08, 54.87, 54.62, 55.41, 56.29, 57.29, 57.29, 57.15, 57.36, 56.56, 56.74, 56.83, 56.92, 58.18, 58.69, 58.69, 59.75, 60.03, 60.40, 61.55, 60.79, 61.15, 60.88, 59.70, 58.59, 59.16, 58.34, 59.28, 58.18, 58.66, 59.44, 59.82, 60.34, 61.48, 60.65, 60.78, 60.69, 59.54, 59.25, 60.40, 60.06, 60.76, 60.91, 60.16, 59.17, 57.66, 56.87, 57.48, 57.64, 57.47, 57.48, 57.29, 57.85, 58.01, 57.40, 57.49, 57.23, 57.72, 57.06, 57.37, 57.13, 56.83, 56.82, 56.82, 56.94, 57.24, 57.37, 56.84, 57.03, 56.73, 56.79, 56.29, 56.22, 56.41, 56.69, 56.74, 56.75, 56.86, 56.52, 56.96, 56.32, 56.57, 56.42, 56.67, 56.81, 57.42, 57.67, 57.26, 57.96, 58.27, 58.48, 58.47, 58.60, 58.97, 59.02, 59.19, 59.28, 59.25, 58.95, 58.80, 58.67, 58.78, 58.82, 59.03, 59.18, 58.68, 58.52, 58.48, 58.51, 58.04, 57.72, 57.81, 57.78, 58.40, 58.19, 58.29, 58.59, 58.42, 58.35, 58.45, 58.80, 59.16, 58.93, 58.99, 59.33, 58.99, 59.19, 59.38, 59.30, 59.32, 58.97, 58.96, 58.90, 59.04, 59.23, 58.96, 59.27, 58.89, 58.80, 58.56, 58.39, 58.35, 58.17, 58.23, 58.30, 58.38, 58.12, 57.42, 57.48, 57.77, 57.83, 57.74, 57.80, 57.65, 57.83, 58.21, 58.31, 57.67, 57.66, 57.70, 57.57, 57.72, 57.65, 57.33, 57.42, 57.78, 58.00, 58.00, 58.29, 58.13, 57.63, 57.16, 56.94, 56.67, 56.73, 56.72, 56.77, 56.60, 56.74, 56.66, 56.92, 56.92, 56.81, 56.88, 57.15, 57.19, 57.44, 57.44, 57.40, 57.09, 57.10, 56.90, 57.07, 56.81, 56.63, 56.47, 56.32, 56.10, 56.39, 56.36, 55.82, 55.94, 56.07, 56.33, 56.04, 56.04, 56.05, 56.29, 56.57, 56.58, 56.42, 56.61, 56.58, 56.51, 56.36, 56.26, 56.30, 56.27, 55.90, 55.63, 55.61, 55.74, 55.94, 55.86, 55.88, 55.82, 55.83, 55.96, 56.10, 56.16, 55.98, 56.17, 56.28, 56.29, 56.38, 56.21, 56.25, 56.25, 56.36, 56.40, 56.11, 56.10, 56.07, 56.22, 56.19, 56.28, 56.37, 56.46, 56.45, 56.21, 56.21, 55.94, 55.96, 55.95, 55.78, 55.91, 55.91, 55.88, 55.97, 56.12, 56.31, 56.36, 56.22, 56.27, 56.10, 56.34, 56.15, 56.30, 56.35, 56.57, 56.67, 56.67, 56.54, 56.73, 56.84, 56.64, 56.66, 56.64, 56.55, 56.32, 56.40, 56.48, 56.36, 56.24, 56.23, 56.20, 56.31, 56.19, 56.15, 56.13, 56.03, 55.79, 55.64, 55.87, 55.98, 56.12, 56.22, 56.30, 56.39, 56.54, 56.69, 56.81, 56.78, 56.70, 56.83, 56.95, 56.94, 56.96, 56.94, 56.95, 56.84],
          label: 'cumulative strke rate'
        }
      ],
      chartLabels: ["2003-05-22", "2003-05-22", "2003-06-05", "2003-06-05", "2003-07-24", "2003-07-24", "2003-07-31", "2003-08-14", "2003-08-14", "2003-08-21", "2003-08-21", "2003-09-04", "2003-09-04", "2003-12-18", "2004-07-29", "2004-07-29", "2004-08-12", "2004-08-12", "2004-08-19", "2004-08-19", "2005-01-13", "2005-01-13", "2006-03-18", "2006-03-18", "2006-11-23", "2006-11-23", "2006-12-01", "2006-12-01", "2007-01-02", "2007-01-02", "2007-07-19", "2007-07-19", "2007-07-27", "2007-07-27", "2007-08-09", "2007-08-09", "2007-12-01", "2007-12-01", "2008-03-13", "2008-03-13", "2008-03-22", "2008-03-22", "2008-05-15", "2008-05-15", "2008-05-23", "2008-05-23", "2008-06-05", "2008-06-05", "2008-07-10", "2008-07-10", "2008-07-18", "2008-07-18", "2008-07-30", "2008-07-30", "2008-08-07", "2008-08-07", "2008-12-11", "2008-12-11", "2008-12-19", "2008-12-19", "2009-02-13", "2009-02-15", "2009-02-15", "2009-02-26", "2009-03-06", "2009-03-06", "2009-05-06", "2009-05-06", "2009-05-14", "2009-05-14", "2009-07-08", "2009-07-16", "2009-07-16", "2009-07-30", "2009-07-30", "2009-08-07", "2009-08-20", "2009-08-20", "2009-12-16", "2009-12-16", "2009-12-26", "2009-12-26", "2010-01-03", "2010-01-03", "2010-01-14", "2010-05-27", "2010-05-27", "2010-06-04", "2010-06-04", "2010-07-29", "2010-07-29", "2010-08-06", "2010-08-06", "2010-08-18", "2010-08-18", "2010-08-26", "2010-08-26", "2010-11-25", "2010-11-25", "2010-12-03", "2010-12-03", "2010-12-16", "2010-12-16", "2010-12-26", "2010-12-26", "2011-01-03", "2011-01-03", "2011-05-26", "2011-05-26", "2011-06-16", "2011-06-16", "2011-07-21", "2011-07-21", "2011-07-29", "2011-07-29", "2011-08-10", "2011-08-10", "2011-08-18", "2011-08-18", "2012-01-17", "2012-01-17", "2012-01-25", "2012-01-25", "2012-02-03", "2012-02-03", "2012-03-26", "2012-03-26", "2012-04-03", "2012-04-03", "2012-05-17", "2012-05-17", "2012-05-25", "2012-05-25", "2012-07-19", "2012-08-02", "2012-08-02", "2012-08-16", "2012-08-16", "2012-11-15", "2012-11-15", "2012-11-23", "2012-11-23", "2012-12-05", "2012-12-05", "2012-12-13", "2013-03-06", "2013-03-14", "2013-03-14", "2013-03-22", "2013-03-22", "2013-05-16", "2013-05-16", "2013-05-24", "2013-05-24", "2013-07-10", "2013-07-10", "2013-07-18", "2013-07-18", "2013-08-01", "2013-08-01", "2013-08-09", "2013-08-09", "2013-08-21", "2013-08-21", "2013-11-21", "2013-11-21", "2013-12-05", "2013-12-05", "2013-12-13", "2013-12-13", "2013-12-26", "2013-12-26", "2014-01-03", "2014-01-03", "2014-06-12", "2014-06-12", "2014-06-20", "2014-06-20", "2014-07-09", "2014-07-09", "2014-07-17", "2014-07-17", "2014-07-27", "2014-07-27", "2014-08-07", "2014-08-07", "2014-08-15", "2014-08-15", "2015-04-13", "2015-04-13", "2015-04-21", "2015-04-21", "2015-05-01", "2015-05-01", "2015-05-21", "2015-05-21", "2015-05-29", "2015-05-29", "2015-07-08", "2015-07-08", "2015-07-16", "2015-07-16", "2015-07-29", "2015-07-29", "2015-10-13", "2015-10-13", "2015-10-22", "2015-10-22", "2015-11-01", "2015-11-01", "2016-01-02", "2016-01-14", "2016-01-14", "2016-01-22", "2016-01-22", "2016-05-19", "2016-05-19", "2016-05-27", "2016-05-27", "2016-06-09", "2016-06-09", "2016-07-22", "2016-07-22", "2016-08-03", "2016-08-03", "2016-08-11", "2016-08-11", "2016-11-17", "2016-11-17", "2016-11-26", "2016-11-26", "2016-12-08", "2017-07-06", "2017-07-06", "2017-07-14", "2017-07-14", "2017-07-27", "2017-07-27", "2017-08-04", "2017-08-04", "2017-08-17", "2017-08-17", "2017-08-25", "2017-08-25", "2017-09-07", "2017-09-07", "2017-11-23", "2017-11-23", "2017-12-02", "2017-12-02", "2017-12-14", "2017-12-26", "2017-12-26", "2018-01-04", "2018-03-22", "2018-03-30", "2018-03-30", "2018-05-24", "2018-05-24", "2018-06-01", "2018-06-01", "2018-08-01", "2018-08-01", "2018-08-09", "2018-08-09", "2018-08-18", "2018-08-18", "2018-08-30", "2018-08-30", "2018-09-07", "2018-09-07", "2018-11-06", "2018-11-06", "2018-11-14", "2018-11-14", "2019-01-23", "2019-01-23", "2019-01-31", "2019-01-31", "2019-02-09", "2019-02-09", "2019-08-01", "2019-08-01", "2019-12-26", "2019-12-26", "2020-01-03", "2020-01-03", "2020-07-08", "2020-07-08", "2020-07-24", "2020-07-24", "2020-08-05", "2020-08-05", "2020-08-13", "2020-08-21", "2020-08-21", "2021-01-22", "2021-01-22", "2021-02-05", "2021-02-05", "2021-02-24", "2021-02-24", "2021-03-04", "2021-06-02", "2021-06-02", "2021-06-10", "2021-06-10", "2021-08-04", "2021-08-04", "2021-08-12", "2021-08-12", "2021-08-25", "2021-08-25", "2021-09-02", "2021-09-02", "2021-12-16", "2021-12-16", "2021-12-26", "2022-01-05", "2022-01-05", "2022-06-02", "2022-06-02", "2022-06-10", "2022-06-10", "2022-07-01", "2022-07-01", "2022-08-17", "2022-08-25", "2022-08-25", "2022-09-08", "2022-09-08", "2022-12-01", "2022-12-01", "2022-12-09", "2022-12-09", "2023-02-16", "2023-02-16", "2023-02-24", "2023-02-24", "2023-06-16", "2023-06-16", "2023-06-28", "2023-06-28", "2023-07-19", "2023-07-19", "2023-07-27", "2023-07-27", "2024-02-02", "2024-02-02", "2024-02-15", "2024-02-15", "2024-02-23", "2024-02-23", "2024-03-07", "2024-07-10", "2024-07-10"]
    }
  }

  public remove(): void {

    console.log(this.data.chartData[0].data.length - 1)



    // this.data.chartData[0].data.shift();
    this.data.chartData[0].data.splice(0, 14);
    this.data.chartLabels.splice(0, 14);
    this.chart?.update();

  }


  public lineChartOptions: ChartConfiguration<'line'>['options'] = {
    responsive: true,
    plugins: {
      datalabels: {
        borderRadius: 4,
        color: 'black',
        // font: {
        //   weight: 'bold'
        // },
        padding: 6,
        align: 'start',
        anchor: 'start',
        formatter: (val, ctx) => ctx.dataIndex === this.data.chartData[0].data.length - 1 ? val : ''
        // {
        //   // console.log(ctx.dataIndex)
        //   if (ctx.dataIndex === this.data.chartData[0].data.length - 1) {
        //     return val;
        //   } else {
        //     return '';
        //   }
        // }
      },
      title: {
        display: true,
        text: 'JM Anderson'
      },
      subtitle: {
        display: true,
        text: 'Strike rate',
        // color: 'blue',
        // font: {
        //   size: 12,
        //   family: 'tahoma',
        //   weight: 'normal',
        //   style: 'italic'
        // }
      }
    }
  };
}